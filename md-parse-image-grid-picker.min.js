/**
 * themeans-core - 
 * @version v0.2.0 - 2015-04-15
 * @link 
 * @license 
 */
"use strict";angular.module("tm.md-parse-image-grid-picker",["tm.parse","ngMaterial"]).directive("parseImageGridPicker",["$window",function(a){return{template:'<md-grid-list md-cols="{{ mdCols || 3 }}" md-cols-sm="{{ mdColsSm || \'\' }}" md-cols-md="{{ mdColsMd || \'\' }}" md-cols-lg="{{ mdColsLg || \'\' }}" md-gutter="{{ mdGutter || \'10px\' }}" md-row-height="{{ mdRowHeight || \'1:1\' }}"><md-grid-tile md-rowspan="{{ mdRowSpan || 1 }}" md-colspan="{{ mdColSpan || 1 }}" md-rowspan-sm="{{ mdRowSpanSm || \'\' }}" md-rowspan-md="{{ mdRowSpanMd || \'\' }}" md-rowspan-lg="{{ mdRowSpanLg || \'\' }}" md-colspan-sm="{{ mdColSpanSm || \'\' }}" md-colspan-md="{{ mdColSpanMd || \'\' }}" md-colspan-lg="{{ mdColSpanLg || \'\' }}" ng-if="gallery.length" ng-repeat="file in gallery track by $index"><img ng-src="{{ file._url }}" style="width: inherit; height: inherit;" /></md-grid-tile><md-grid-tile md-rowspan="{{ mdRowSpan || 1 }}" md-colspan="{{ mdColSpan || 1 }}" md-rowspan-sm="{{ mdRowSpanSm || \'\' }}" md-rowspan-md="{{ mdRowSpanMd || \'\' }}" md-rowspan-lg="{{ mdRowSpanLg || \'\' }}" md-colspan-sm="{{ mdColSpanSm || \'\' }}" md-colspan-md="{{ mdColSpanMd || \'\' }}" md-colspan-lg="{{ mdColSpanLg || \'\' }}"><img style="width: inherit; height: inherit; padding: {{ imagePlaceHolderPadding }};" ng-show="placeHolder.length" ng-src="{{placeHolder}}"><img style="width: inherit; height: inherit; padding: 40px;" ng-show="!placeHolder.length" ng-src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4PSIwcHgiIHk9IjBweCIgd2lkdGg9Ijk3LjM0MXB4IiBoZWlnaHQ9IjEwMHB4IiB2aWV3Qm94PSIwIDAgOTcuMzQxIDEwMCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgOTcuMzQxIDEwMCIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PGc+PHBhdGggZD0iTTAsMTAwaDY2Ljg1MlYxOS4zNzJIMFYxMDB6IE00LjU3MiwyNC44ODZINjIuMjhWODEuNTJINC41NzJWMjQuODg2eiIvPjxwb2x5Z29uIHBvaW50cz0iMzAuODk4LDAgMjguOTgzLDE3LjIyMyAzMy41ODMsMTcuMjIzIDM0LjgzMyw1Ljk4NiA5Mi4xODgsMTIuMzYzIDg1LjkyOSw2OC42NSA2OC43ODEsNjYuNzQzIDY4Ljc4MSw4NS4zMzYgICAgODguNDMxLDg3LjUyMiA5Ny4zNDEsNy4zODcgICIvPjwvZz48L3N2Zz4="><md-button style="position: absolute; left: {{ buttonSvgLeft || \'144px\' }}; top: {{ buttonSvgRight || \'65px\' }};" class="md-fab md-mini md-primary" aria-label="Add Gallery Image" ng-disabled="loading" ng-click="getFile()"><md-icon md-svg-src="images/shared/icons/plus.svg"></md-icon></md-button></md-grid-tile></md-grid-list><div style="height: 0px;width:0px; overflow:hidden;"><input id="upfile" type="file" name="image" onchange="angular.element(this).scope().imageInputOnChange(this)"/></div>',restrict:"E",scope:{gallery:"=resultsArray",mdCols:"@",mdColsSm:"@",mdColsMd:"@",mdColsLg:"@",mdGutter:"@",mdRowHeight:"@",mdRowSpan:"@",mdColSpan:"@",mdRowSpanSm:"@",mdRowSpanMd:"@",mdRowSpanLg:"@",mdColSpanSm:"@",mdColSpanMd:"@",mdColSpanLg:"@",cropper:"=",cropAspectRatio:"=",cropHeight:"=",cropWidth:"=",buttonSvgIconUrl:"@",buttonSvgLeft:"@",buttonSvgRight:"@",imagePlaceHolder:"@",imagePlaceHolderPadding:"@",onSuccessCallback:"="},link:{pre:function(){},post:function(){}},controller:["Parse","$scope","$mdDialog","$q",function(b,c,d,e){function f(a,d){var f=e.defer(),g=a.replace(/[^a-zA-Z0-9]+/gi,"-");return c.image=new b.File(g,d),c.image.save({success:function(a){f.resolve(a)},error:function(a,b){f.reject(b)}}),f.promise}c.loading=!1,c.getFile=function(){document.getElementById("upfile").click()},c.imageInputOnChange=function(b){var e=b.files[0];if(e&&e.name){var g=e.name;return c.$evalAsync(function(){c.loading=!0}),c.cropper?void d.show({template:'<md-dialog><md-content><img></md-content><div class="md-actions"><md-button ng-click="saveCrop()">Save</md-button><md-button ng-click="closeDialog()">Close</md-button></div></md-dialog>',locals:{file:e,aspectRatio:c.aspectRatio,cropHeight:c.cropHeight,cropWidth:c.cropWidth},controller:["$scope","file","aspectRatio","cropHeight","cropWidth",function(a,b,c,e,f){a.file=b,a.aspectRatio=c,a.cropHeight=e,a.cropWidth=f,a.saveCrop=function(){var b=a.canvas.cropper("getDataURL",{width:a.cropWidth,height:a.cropHeight});d.hide(b)},a.closeDialog=function(){d.cancel()}}],onComplete:function(b,c){b.imgEl=c[0].getElementsByTagName("img")[0];var d={};b.aspectRatio&&(d.aspectRatio=b.aspectRatio);var e=new FileReader;e.onload=function(){e.readyState===e.DONE&&(b.canvas=a.jQuery(b.imgEl).cropper(d).cropper("replace",e.result))},e.readAsDataURL(b.file)}}).then(function(a){f(g,{base64:a}).then(function(a){c.loading=!1,c.gallery.push(a),c.onSuccessCallback(a)},function(){c.loading=!1,d.show(d.alert().title("Server Error").content("There has been an error with the remote server, try uploading the file again").ok("Close"))})},function(){c.loading=!1}):void f(g,e).then(function(a){c.loading=!1,c.gallery.push(a),c.onSuccessCallback(a)},function(){c.loading=!1,d.show(d.alert().title("Server Error").content("There has been an error with the remote server, try uploading the file again").ok("Close"))})}}}]}}]),angular.module("tm.md-parse-image-grid-picker",["tm.parse","ngMaterial"]).directive("parseImageGridPicker",["$window",function(a){return{template:'<md-grid-list md-cols="{{ mdCols || 3 }}" md-cols-sm="{{ mdColsSm || \'\' }}" md-cols-md="{{ mdColsMd || \'\' }}" md-cols-lg="{{ mdColsLg || \'\' }}" md-gutter="{{ mdGutter || \'10px\' }}" md-row-height="{{ mdRowHeight || \'1:1\' }}"><md-grid-tile md-rowspan="{{ mdRowSpan || 1 }}" md-colspan="{{ mdColSpan || 1 }}" md-rowspan-sm="{{ mdRowSpanSm || \'\' }}" md-rowspan-md="{{ mdRowSpanMd || \'\' }}" md-rowspan-lg="{{ mdRowSpanLg || \'\' }}" md-colspan-sm="{{ mdColSpanSm || \'\' }}" md-colspan-md="{{ mdColSpanMd || \'\' }}" md-colspan-lg="{{ mdColSpanLg || \'\' }}" ng-if="gallery.length" ng-repeat="file in gallery track by $index"><img ng-src="{{ file._url }}" style="width: inherit; height: inherit;" /></md-grid-tile><md-grid-tile md-rowspan="{{ mdRowSpan || 1 }}" md-colspan="{{ mdColSpan || 1 }}" md-rowspan-sm="{{ mdRowSpanSm || \'\' }}" md-rowspan-md="{{ mdRowSpanMd || \'\' }}" md-rowspan-lg="{{ mdRowSpanLg || \'\' }}" md-colspan-sm="{{ mdColSpanSm || \'\' }}" md-colspan-md="{{ mdColSpanMd || \'\' }}" md-colspan-lg="{{ mdColSpanLg || \'\' }}"><img style="width: inherit; height: inherit; padding: {{ imagePlaceHolderPadding }};" ng-show="placeHolder.length" ng-src="{{placeHolder}}"><img style="width: inherit; height: inherit; padding: 40px;" ng-show="!placeHolder.length" ng-src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4PSIwcHgiIHk9IjBweCIgd2lkdGg9Ijk3LjM0MXB4IiBoZWlnaHQ9IjEwMHB4IiB2aWV3Qm94PSIwIDAgOTcuMzQxIDEwMCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgOTcuMzQxIDEwMCIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PGc+PHBhdGggZD0iTTAsMTAwaDY2Ljg1MlYxOS4zNzJIMFYxMDB6IE00LjU3MiwyNC44ODZINjIuMjhWODEuNTJINC41NzJWMjQuODg2eiIvPjxwb2x5Z29uIHBvaW50cz0iMzAuODk4LDAgMjguOTgzLDE3LjIyMyAzMy41ODMsMTcuMjIzIDM0LjgzMyw1Ljk4NiA5Mi4xODgsMTIuMzYzIDg1LjkyOSw2OC42NSA2OC43ODEsNjYuNzQzIDY4Ljc4MSw4NS4zMzYgICAgODguNDMxLDg3LjUyMiA5Ny4zNDEsNy4zODcgICIvPjwvZz48L3N2Zz4="><md-button style="position: absolute; left: {{ buttonSvgLeft || \'144px\' }}; top: {{ buttonSvgRight || \'65px\' }};" class="md-fab md-mini md-primary" aria-label="Add Gallery Image" ng-disabled="loading" ng-click="getFile()"><md-icon md-svg-src="images/shared/icons/plus.svg"></md-icon></md-button></md-grid-tile></md-grid-list><div style="height: 0px;width:0px; overflow:hidden;"><input id="upfile" type="file" name="image" onchange="angular.element(this).scope().imageInputOnChange(this)"/></div>',restrict:"E",scope:{gallery:"=resultsArray",mdCols:"@",mdColsSm:"@",mdColsMd:"@",mdColsLg:"@",mdGutter:"@",mdRowHeight:"@",mdRowSpan:"@",mdColSpan:"@",mdRowSpanSm:"@",mdRowSpanMd:"@",mdRowSpanLg:"@",mdColSpanSm:"@",mdColSpanMd:"@",mdColSpanLg:"@",cropper:"=",cropAspectRatio:"=",cropHeight:"=",cropWidth:"=",buttonSvgIconUrl:"@",buttonSvgLeft:"@",buttonSvgRight:"@",imagePlaceHolder:"@",imagePlaceHolderPadding:"@",onSuccessCallback:"="},link:{pre:function(){},post:function(){}},controller:["Parse","$scope","$mdDialog","$q",function(b,c,d,e){function f(a,d){var f=e.defer(),g=a.replace(/[^a-zA-Z0-9]+/gi,"-");return c.image=new b.File(g,d),c.image.save({success:function(a){f.resolve(a)},error:function(a,b){f.reject(b)}}),f.promise}c.loading=!1,c.getFile=function(){document.getElementById("upfile").click()},c.imageInputOnChange=function(b){var e=b.files[0];if(e&&e.name){var g=e.name;return c.$evalAsync(function(){c.loading=!0}),c.cropper?void d.show({template:'<md-dialog><md-content><img></md-content><div class="md-actions"><md-button ng-click="saveCrop()">Save</md-button><md-button ng-click="closeDialog()">Close</md-button></div></md-dialog>',locals:{file:e,aspectRatio:c.aspectRatio,cropHeight:c.cropHeight,cropWidth:c.cropWidth},controller:["$scope","file","aspectRatio","cropHeight","cropWidth",function(a,b,c,e,f){a.file=b,a.aspectRatio=c,a.cropHeight=e,a.cropWidth=f,a.saveCrop=function(){var b=a.canvas.cropper("getDataURL",{width:a.cropWidth,height:a.cropHeight});d.hide(b)},a.closeDialog=function(){d.cancel()}}],onComplete:function(b,c){b.imgEl=c[0].getElementsByTagName("img")[0];var d={};b.aspectRatio&&(d.aspectRatio=b.aspectRatio);var e=new FileReader;e.onload=function(){e.readyState===e.DONE&&(b.canvas=a.jQuery(b.imgEl).cropper(d).cropper("replace",e.result))},e.readAsDataURL(b.file)}}).then(function(a){f(g,{base64:a}).then(function(a){c.loading=!1,c.gallery.push(a),c.onSuccessCallback(a)},function(){c.loading=!1,d.show(d.alert().title("Server Error").content("There has been an error with the remote server, try uploading the file again").ok("Close"))})},function(){c.loading=!1}):void f(g,e).then(function(a){c.loading=!1,c.gallery.push(a),c.onSuccessCallback(a)},function(){c.loading=!1,d.show(d.alert().title("Server Error").content("There has been an error with the remote server, try uploading the file again").ok("Close"))})}}}]}}]);